<div align="right" dir="rtl">

# اسکریپت هوشمند نصب BBR
</div>

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Shell Script](https://img.shields.io/badge/Shell-Bash-green.svg)](https://www.gnu.org/software/bash/)
[![Linux](https://img.shields.io/badge/Platform-Linux-blue.svg)](https://www.linux.org/)
[![Kernel](https://img.shields.io/badge/Kernel-4.9%2B-orange.svg)](https://www.kernel.org/)

> **[🇺🇸 For English documentation, click here](README.md)**

<div align="center">
  <img src="https://raw.githubusercontent.com/vUnkname/BBR-Smart/main/screenshot.png" alt="تصویر اسکریپت BBR Smart" width="529">
</div>

<style>.art_body *{direction:rtl !important;text-align:right !important;}</style>
<div class="art_body">

اسکریپت هوشمند، خودکار و مدیریتی برای نصب کنترل ازدحام TCP با الگوریتم BBR (Bottleneck Bandwidth and Round-trip propagation time) در سیستم‌های لینوکس. این اسکریپت به طور خودکار قابلیت‌های سیستم شما را تشخیص داده و بهترین روش پیاده‌سازی BBR را انتخاب می‌کند.

## 🚀 ویژگی‌ها

- **🔍 تشخیص خودکار سیستم**: تشخیص نسخه کرنل، توزیع و معماری
- **🧠 انتخاب هوشمند روش**: انتخاب بین روش‌های مدرن (BBRv2) و قدیمی BBR
- **⚡ بدون نیاز به راه‌اندازی مجدد**: اعمال تغییرات فوری بدون ریستارت سیستم
- **🛡️ مدیریت جامع خطا**: بررسی قوی خطا و بازخورد کاربر
- **📊 تست عملکرد**: تست و مقایسه عملکرد شبکه داخلی
- **🔧 بهینه‌سازی عملکرد**: بهینه‌سازی‌های پیشرفته TCP برای حداکثر عملکرد
- **💻 پشتیبانی مجازی‌سازی**: سازگار با اکثر پلتفرم‌های مجازی‌سازی
- **📋 منوی تعاملی**: سیستم منوی کاربرپسند برای مدیریت آسان
- **🔄 حذف آسان**: حذف کامل پیکربندی‌های BBR

## 📋 نیازمندی‌های سیستم

- **سیستم عامل**: هر توزیع لینوکس
- **نسخه کرنل**: 4.9 یا بالاتر
- **معماری**: x86_64، ARM64، یا سایر معماری‌های پشتیبانی شده
- **مجوزها**: دسترسی root مورد نیاز
- **مجازی‌سازی**: سازگار با KVM، VMware، Xen (نه OpenVZ/LXC)

## 🛠️ نصب

### نصب سریع (توصیه شده)

```bash
bash <(curl -Ls https://raw.githubusercontent.com/vUnkname/BBR-Smart/main/bbr-smart.sh)
```

### نصب دستی

```bash
# دانلود اسکریپت
wget https://raw.githubusercontent.com/vUnkname/BBR-Smart/main/bbr-smart.sh

# قابل اجرا کردن
chmod +x bbr-smart.sh

# اجرا با مجوزهای root
sudo ./bbr-smart.sh
```

## 📖 استفاده

### حالت تعاملی

اسکریپت را بدون آرگومان اجرا کنید تا به منوی تعاملی دسترسی پیدا کنید:

```bash
sudo ./bbr-smart.sh
```

### حالت خط فرمان

اسکریپت از آرگومان‌های مختلف خط فرمان برای خودکارسازی پشتیبانی می‌کند:

```bash
# نصب BBR با تست عملکرد اختیاری
sudo ./bbr-smart.sh install

# حذف کامل BBR
sudo ./bbr-smart.sh uninstall

# بررسی وضعیت BBR
sudo ./bbr-smart.sh status

# نمایش اطلاعات سیستم
sudo ./bbr-smart.sh info

# تست عملکرد شبکه قبل از BBR
sudo ./bbr-smart.sh test-before

# تست عملکرد شبکه بعد از BBR
sudo ./bbr-smart.sh test-after

# مقایسه نتایج عملکرد
sudo ./bbr-smart.sh compare

# نصب ابزارهای تست شبکه
sudo ./bbr-smart.sh install-tools

# نمایش لاگ تست عملکرد
sudo ./bbr-smart.sh show-log
```

## 🔧 کارکرد BBR

BBR (Bottleneck Bandwidth and Round-trip propagation time) الگوریتم کنترل ازدحامی است که توسط گوگل توسعه یافته و:

- **بهبود عملکرد شبکه**: افزایش قابل توجه throughput و کاهش تأخیر
- **بهینه‌سازی استفاده از پهنای باند**: استفاده بهتر از پهنای باند موجود شبکه
- **کاهش Bufferbloat**: کمینه‌سازی بافرینگ بیش از حد در تجهیزات شبکه
- **کارکرد جهانی**: مؤثر در شرایط و توپولوژی‌های مختلف شبکه

### بهبودهای عملکرد

بهبودهای معمول با BBR:
- **2-25 برابر throughput بالاتر** در اتصالات طولانی
- **کاهش تأخیر** 25-40%
- **عملکرد بهتر** در شبکه‌های با از دست رفتن بالا
- **عدالت بهبود یافته** بین جریان‌های رقیب

## 📊 تست عملکرد

اسکریپت شامل تست جامع عملکرد شبکه است:

### معیارهای تست
- **سرعت دانلود**: اندازه‌گیری throughput واقعی دانلود
- **تأخیر**: تست زمان رفت و برگشت به Google DNS (8.8.8.8)
- **زمان اتصال TCP**: اندازه‌گیری سرعت برقراری اتصال
- **پهنای باند**: استفاده از iperf3 برای تجزیه و تحلیل دقیق پهنای باند

### گردش کار تست
1. اجرای تست عملکرد قبل از نصب BBR
2. نصب و پیکربندی BBR
3. اجرای تست عملکرد بعد از نصب BBR
4. مقایسه نتایج برای مشاهده بهبودها

## 🏗️ جزئیات فنی

### روش مدرن (کرنل 5.4+)
- استفاده از BBRv2 با بهینه‌سازی‌های پیشرفته
- پیکربندی اندازه‌های بافر بهینه
- فعال‌سازی TCP Fast Open و MTU probing
- اعمال بهینه‌سازی‌های TCP مدرن

### روش قدیمی (کرنل 4.9-5.3)
- استفاده از پیاده‌سازی استاندارد BBR
- پیکربندی پایه برای سازگاری
- حفظ ثبات در سیستم‌های قدیمی‌تر

### فایل‌های پیکربندی
- **مدرن**: `/etc/sysctl.d/99-bbr-smart.conf`
- **قدیمی**: تغییر `/etc/sysctl.conf`
- **بارگذاری ماژول**: `/etc/modules-load.d/bbr-smart.conf`

## 🔍 تأیید

بعد از نصب، کارکرد BBR را تأیید کنید:

```bash
# بررسی الگوریتم کنترل ازدحام
sysctl net.ipv4.tcp_congestion_control

# تأیید بارگذاری ماژول BBR
lsmod | grep tcp_bbr

# استفاده از تأیید اسکریپت
sudo ./bbr-smart.sh status
```

## 🚫 حذف

برای حذف کامل BBR و بازگردانی تنظیمات پیش‌فرض:

```bash
sudo ./bbr-smart.sh uninstall
```

این کار:
- تمام فایل‌های پیکربندی BBR را حذف می‌کند
- به کنترل ازدحام پیش‌فرض (cubic) بازمی‌گردد
- پیکربندی‌های بارگذاری ماژول را پاک می‌کند

## 🐛 عیب‌یابی

### مشکلات رایج

**BBR بعد از نصب فعال نمی‌شود:**
- اطمینان حاصل کنید نسخه کرنل 4.9 یا بالاتر است
- بررسی کنید که در محیط مجازی‌سازی پشتیبانی شده اجرا می‌شود
- تأیید کنید ماژول tcp_bbr موجود است

**تست‌های عملکرد شکست می‌خورند:**
- ابزارهای مورد نیاز را نصب کنید: `sudo ./bbr-smart.sh install-tools`
- اتصال اینترنت را بررسی کنید
- اطمینان حاصل کنید فایروال اتصالات خروجی را مجاز می‌داند

**خطاهای مجوز اسکریپت:**
- با sudo اجرا کنید: `sudo ./bbr-smart.sh`
- اطمینان حاصل کنید اسکریپت قابل اجرا است: `chmod +x bbr-smart.sh`

### پلتفرم‌های پشتیبانی شده

✅ **پشتیبانی شده:**
- Ubuntu 18.04+
- Debian 9+
- CentOS 7+
- RHEL 7+
- Fedora 28+
- Amazon Linux 2
- مجازی‌سازی KVM، VMware، Xen

❌ **پشتیبانی نشده:**
- کانتینرهای OpenVZ
- کانتینرهای LXC
- کرنل‌های قدیمی‌تر از 4.9

## 📝 تغییرات

برای تاریخچه دقیق نسخه‌ها [CHANGELOG.md](CHANGELOG.md) را ببینید.

## 🤝 مشارکت

مشارکت‌ها خوش‌آمد هستند! لطفاً قبل از ارسال pull request، [راهنمای مشارکت](CONTRIBUTING.md) را بخوانید.

### توسعه

1. مخزن را Fork کنید
2. شاخه ویژگی ایجاد کنید
3. تغییرات خود را اعمال کنید
4. به طور کامل تست کنید
5. pull request ارسال کنید

## 📄 مجوز

این پروژه تحت مجوز MIT منتشر شده است - برای جزئیات فایل [LICENSE](LICENSE) را ببینید.

## 🙏 قدردانی‌ها

- گوگل برای توسعه الگوریتم BBR
- توسعه‌دهندگان کرنل لینوکس برای پیاده‌سازی BBR
- مشارکت‌کنندگان و تست‌کنندگان جامعه

## 📞 پشتیبانی

اگر با مشکلی مواجه شدید یا سوالی دارید:

1. [بخش عیب‌یابی](#-عیب‌یابی) را بررسی کنید
2. [مسائل موجود](https://github.com/vUnkname/BBR-Smart/issues) را جستجو کنید
3. [مسئله جدید](https://github.com/vUnkname/BBR-Smart/issues/new) با اطلاعات دقیق ایجاد کنید

## ⭐ تاریخچه ستاره

اگر این پروژه به شما کمک کرد، لطفاً ستاره دادن را در نظر بگیرید! ⭐

---

**با ❤️ برای جامعه ساخته شده**
</div>
